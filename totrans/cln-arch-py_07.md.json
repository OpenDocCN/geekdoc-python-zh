["```py\nfrom rentomatic.requests.room_list import RoomListRequest\n\ndef test_build_room_list_request_without_parameters():\n    request = RoomListRequest()\n\n    assert bool(request) is True\n\ndef test_build_room_list_request_from_empty_dict():\n    request = RoomListRequest.from_dict({})\n\n    assert bool(request) is True \n```", "```py\nclass RoomListRequest:\n    @classmethod\n    def from_dict(cls, adict):\n        return cls()\n\n    def __bool__(self):\n        return True \n```", "```py\n*from rentomatic.responses import ResponseSuccess\n\ndef test_response_success_is_true():\n    assert bool(ResponseSuccess()) is True* \n```", "```py\n*class ResponseSuccess:\n    def __init__(self, value=None):\n        self.value = value\n\n    def __bool__(self):\n        return True* \n```", "```py\n**import pytest\nimport uuid\nfrom unittest import mock\n\nfrom rentomatic.domain.room import Room\nfrom rentomatic.use_cases.room_list import room_list_use_case\nfrom rentomatic.requests.room_list import RoomListRequest\n\n@pytest.fixture\ndef domain_rooms():\n    room_1 = Room(\n        code=uuid.uuid4(),\n        size=215,\n        price=39,\n        longitude=-0.09998975,\n        latitude=51.75436293,\n    )\n\n    room_2 = Room(\n        code=uuid.uuid4(),\n        size=405,\n        price=66,\n        longitude=0.18228006,\n        latitude=51.74640997,\n    )\n\n    room_3 = Room(\n        code=uuid.uuid4(),\n        size=56,\n        price=60,\n        longitude=0.27891577,\n        latitude=51.45994069,\n    )\n\n    room_4 = Room(\n        code=uuid.uuid4(),\n        size=93,\n        price=48,\n        longitude=0.33894476,\n        latitude=51.39916678,\n    )\n\n    return [room_1, room_2, room_3, room_4]\n\ndef test_room_list_without_parameters(domain_rooms):\n    repo = mock.Mock()\n    repo.list.return_value = domain_rooms\n\n    request = RoomListRequest()\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is True\n    repo.list.assert_called_with()\n    assert response.value == domain_rooms** \n```", "```py\n**from rentomatic.responses import ResponseSuccess\n\ndef room_list_use_case(repo, request):\n    rooms = repo.list()\n    return ResponseSuccess(rooms)** \n```", "```py\n***from rentomatic.requests.room_list import build_room_list_request\n\ndef test_build_room_list_request_without_parameters():\n    request = build_room_list_request()\n\n    assert request.filters is None\n    assert bool(request) is True\n\ndef test_build_room_list_request_with_empty_filters():\n    request = build_room_list_request({})\n\n    assert request.filters == {}\n    assert bool(request) is True*** \n```", "```py\n***def test_build_room_list_request_with_invalid_filters_parameter():\n    request = build_room_list_request(filters=5)\n\n    assert request.has_errors()\n    assert request.errors[0][\"parameter\"] == \"filters\"\n    assert bool(request) is False\n\ndef test_build_room_list_request_with_incorrect_filter_keys():\n    request = build_room_list_request(filters={\"a\": 1})\n\n    assert request.has_errors()\n    assert request.errors[0][\"parameter\"] == \"filters\"\n    assert bool(request) is False*** \n```", "```py\n***import pytest\n\n...\n\n@pytest.mark.parametrize(\n    \"key\", [\"code__eq\", \"price__eq\", \"price__lt\", \"price__gt\"]\n)\ndef test_build_room_list_request_accepted_filters(key):\n    filters = {key: 1}\n\n    request = build_room_list_request(filters=filters)\n\n    assert request.filters == filters\n    assert bool(request) is True\n\n@pytest.mark.parametrize(\"key\", [\"code__lt\", \"code__gt\"])\ndef test_build_room_list_request_rejected_filters(key):\n    filters = {key: 1}\n\n    request = build_room_list_request(filters=filters)\n\n    assert request.has_errors()\n    assert request.errors[0][\"parameter\"] == \"filters\"\n    assert bool(request) is False*** \n```", "```py\n***from collections.abc import Mapping\n\nclass RoomListInvalidRequest:\n    def __init__(self):\n        self.errors = []\n\n    def add_error(self, parameter, message):\n        self.errors.append({\"parameter\": parameter, \"message\": message})\n\n    def has_errors(self):\n        return len(self.errors) > 0\n\n    def __bool__(self):\n        return False\n\nclass RoomListValidRequest:\n    def __init__(self, filters=None):\n        self.filters = filters\n\n    def __bool__(self):\n        return True\n\ndef build_room_list_request(filters=None):\n    accepted_filters = [\"code__eq\", \"price__eq\", \"price__lt\", \"price__gt\"]\n    invalid_req = RoomListInvalidRequest()\n\n    if filters is not None:\n        if not isinstance(filters, Mapping):\n            invalid_req.add_error(\"filters\", \"Is not iterable\")\n            return invalid_req\n\n        for key, value in filters.items():\n            if key not in accepted_filters:\n                invalid_req.add_error(\n                    \"filters\", \"Key {} cannot be used\".format(key)\n                )\n\n        if invalid_req.has_errors():\n            return invalid_req\n\n    return RoomListValidRequest(filters=filters)*** \n```", "```py\n***...\n\nfrom rentomatic.requests.room_list import build_room_list_request\n\n...\n\ndef test_room_list_without_parameters(domain_rooms):\n    repo = mock.Mock()\n    repo.list.return_value = domain_rooms\n\n    request = build_room_list_request()\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is True\n    repo.list.assert_called_with()\n    assert response.value == domain_rooms*** \n```", "```py\n***from rentomatic.responses import (\n    ResponseSuccess,\n    ResponseFailure,\n    ResponseTypes,\n    build_response_from_invalid_request,\n)\nfrom rentomatic.requests.room_list import RoomListInvalidRequest\n\nSUCCESS_VALUE = {\"key\": [\"value1\", \"value2\"]}\nGENERIC_RESPONSE_TYPE = \"Response\"\nGENERIC_RESPONSE_MESSAGE = \"This is a response\"\n\ndef test_response_success_is_true():\n    response = ResponseSuccess(SUCCESS_VALUE)\n\n    assert bool(response) is True\n\ndef test_response_failure_is_false():\n    response = ResponseFailure(\n        GENERIC_RESPONSE_TYPE, GENERIC_RESPONSE_MESSAGE\n    )\n\n    assert bool(response) is False*** \n```", "```py\n***def test_response_success_has_type_and_value():\n    response = ResponseSuccess(SUCCESS_VALUE)\n\n    assert response.type == ResponseTypes.SUCCESS\n    assert response.value == SUCCESS_VALUE\n\ndef test_response_failure_has_type_and_message():\n    response = ResponseFailure(\n        GENERIC_RESPONSE_TYPE, GENERIC_RESPONSE_MESSAGE\n    )\n\n    assert response.type == GENERIC_RESPONSE_TYPE\n    assert response.message == GENERIC_RESPONSE_MESSAGE\n    assert response.value == {\n        \"type\": GENERIC_RESPONSE_TYPE,\n        \"message\": GENERIC_RESPONSE_MESSAGE,\n    }*** \n```", "```py\n***def test_response_failure_initialisation_with_exception():\n    response = ResponseFailure(\n        GENERIC_RESPONSE_TYPE, Exception(\"Just an error message\")\n    )\n\n    assert bool(response) is False\n    assert response.type == GENERIC_RESPONSE_TYPE\n    assert response.message == \"Exception: Just an error message\"*** \n```", "```py\n***def test_response_failure_from_empty_invalid_request():\n    response = build_response_from_invalid_request(\n        RoomListInvalidRequest()\n    )\n\n    assert bool(response) is False\n    assert response.type == ResponseTypes.PARAMETERS_ERROR\n\ndef test_response_failure_from_invalid_request_with_errors():\n    request = RoomListInvalidRequest()\n    request.add_error(\"path\", \"Is mandatory\")\n    request.add_error(\"path\", \"can't be blank\")\n\n    response = build_response_from_invalid_request(request)\n\n    assert bool(response) is False\n    assert response.type == ResponseTypes.PARAMETERS_ERROR\n    assert response.message == \"path: Is mandatory\\npath: can't be blank\"*** \n```", "```py\n***class ResponseTypes:\n    PARAMETERS_ERROR = \"ParametersError\"\n    RESOURCE_ERROR = \"ResourceError\"\n    SYSTEM_ERROR = \"SystemError\"\n    SUCCESS = \"Success\"\n\nclass ResponseFailure:\n    def __init__(self, type_, message):\n        self.type = type_\n        self.message = self._format_message(message)\n\n    def _format_message(self, msg):\n        if isinstance(msg, Exception):\n            return \"{}: {}\".format(\n                msg.__class__.__name__, \"{}\".format(msg)\n            )\n        return msg\n\n    @property\n    def value(self):\n        return {\"type\": self.type, \"message\": self.message}\n\n    def __bool__(self):\n        return False\n\nclass ResponseSuccess:\n    def __init__(self, value=None):\n        self.type = ResponseTypes.SUCCESS\n        self.value = value\n\n    def __bool__(self):\n        return True\n\ndef build_response_from_invalid_request(invalid_request):\n    message = \"\\n\".join(\n        [\n            \"{}: {}\".format(err[\"parameter\"], err[\"message\"])\n            for err in invalid_request.errors\n        ]\n    )\n    return ResponseFailure(ResponseTypes.PARAMETERS_ERROR, message)*** \n```", "```py\n***def test_room_list_without_parameters(domain_rooms):\n    repo = mock.Mock()\n    repo.list.return_value = domain_rooms\n\n    request = build_room_list_request()\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is True\n    repo.list.assert_called_with(filters=None)\n    assert response.value == domain_rooms*** \n```", "```py\n***import pytest\nimport uuid\nfrom unittest import mock\n\nfrom rentomatic.domain.room import Room\nfrom rentomatic.use_cases.room_list import room_list_use_case\nfrom rentomatic.requests.room_list import build_room_list_request\nfrom rentomatic.responses import ResponseTypes\n\n...\n\ndef test_room_list_with_filters(domain_rooms):\n    repo = mock.Mock()\n    repo.list.return_value = domain_rooms\n\n    qry_filters = {\"code__eq\": 5}\n    request = build_room_list_request(filters=qry_filters)\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is True\n    repo.list.assert_called_with(filters=qry_filters)\n    assert response.value == domain_rooms\n\ndef test_room_list_handles_generic_error():\n    repo = mock.Mock()\n    repo.list.side_effect = Exception(\"Just an error message\")\n\n    request = build_room_list_request(filters={})\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is False\n    assert response.value == {\n        \"type\": ResponseTypes.SYSTEM_ERROR,\n        \"message\": \"Exception: Just an error message\",\n    }\n\ndef test_room_list_handles_bad_request():\n    repo = mock.Mock()\n\n    request = build_room_list_request(filters=5)\n\n    response = room_list_use_case(repo, request)\n\n    assert bool(response) is False\n    assert response.value == {\n        \"type\": ResponseTypes.PARAMETERS_ERROR,\n        \"message\": \"filters: Is not iterable\",\n    }*** \n```", "```py\n***from rentomatic.responses import (\n    ResponseSuccess,\n    ResponseFailure,\n    ResponseTypes,\n    build_response_from_invalid_request,\n)\n\ndef room_list_use_case(repo, request):\n    if not request:\n        return build_response_from_invalid_request(request)\n    try:\n        rooms = repo.list(filters=request.filters)\n        return ResponseSuccess(rooms)\n    except Exception as exc:\n        return ResponseFailure(ResponseTypes.SYSTEM_ERROR, exc)*** \n```", "```py\n***TypeError: room_list_use_case() missing 1 required positional argument: 'request'*** \n```", "```py\n***import json\nfrom unittest import mock\n\nimport pytest\n\nfrom rentomatic.domain.room import Room\nfrom rentomatic.responses import (\n    ResponseFailure,\n    ResponseSuccess,\n    ResponseTypes,\n)\n\nroom_dict = {\n    \"code\": \"3251a5bd-86be-428d-8ae9-6e51a8048c33\",\n    \"size\": 200,\n    \"price\": 10,\n    \"longitude\": -0.09998975,\n    \"latitude\": 51.75436293,\n}\n\nrooms = [Room.from_dict(room_dict)]\n\n@mock.patch(\"application.rest.room.room_list_use_case\")\ndef test_get(mock_use_case, client):\n    mock_use_case.return_value = ResponseSuccess(rooms)\n\n    http_response = client.get(\"/rooms\")\n\n    assert json.loads(http_response.data.decode(\"UTF-8\")) == [room_dict]\n\n    mock_use_case.assert_called()\n    args, kwargs = mock_use_case.call_args\n    assert args[1].filters == {}\n\n    assert http_response.status_code == 200\n    assert http_response.mimetype == \"application/json\"\n\n@mock.patch(\"application.rest.room.room_list_use_case\")\ndef test_get_with_filters(mock_use_case, client):\n    mock_use_case.return_value = ResponseSuccess(rooms)\n\n    http_response = client.get(\n        \"/rooms?filter_price__gt=2&filter_price__lt=6\"\n    )\n\n    assert json.loads(http_response.data.decode(\"UTF-8\")) == [room_dict]\n\n    mock_use_case.assert_called()\n    args, kwargs = mock_use_case.call_args\n    assert args[1].filters == {\"price__gt\": \"2\", \"price__lt\": \"6\"}\n\n    assert http_response.status_code == 200\n    assert http_response.mimetype == \"application/json\"\n\n@pytest.mark.parametrize(\n    \"response_type, expected_status_code\",\n    [\n        (ResponseTypes.PARAMETERS_ERROR, 400),\n        (ResponseTypes.RESOURCE_ERROR, 404),\n        (ResponseTypes.SYSTEM_ERROR, 500),\n    ],\n)\n@mock.patch(\"application.rest.room.room_list_use_case\")\ndef test_get_response_failures(\n    mock_use_case,\n    client,\n    response_type,\n    expected_status_code,\n):\n    mock_use_case.return_value = ResponseFailure(\n        response_type,\n        message=\"Just an error message\",\n    )\n\n    http_response = client.get(\"/rooms?dummy_request_string\")\n\n    mock_use_case.assert_called()\n\n    assert http_response.status_code == expected_status_code*** \n```", "```py\n***mock_use_case.return_value = ResponseSuccess(rooms)*** \n```", "```py\n***mock_use_case.assert_called()\nargs, kwargs = mock_use_case.call_args\nassert args[1].filters == {}*** \n```", "```py\n***assert args[1].filters == {'price__gt': '2', 'price__lt': '6'}*** \n```", "```py\n***import json\n\nfrom flask import Blueprint, request, Response\n\nfrom rentomatic.repository.memrepo import MemRepo\nfrom rentomatic.use_cases.room_list import room_list_use_case\nfrom rentomatic.serializers.room import RoomJsonEncoder\nfrom rentomatic.requests.room_list import build_room_list_request\nfrom rentomatic.responses import ResponseTypes\n\nblueprint = Blueprint(\"room\", __name__)\n\nSTATUS_CODES = {\n    ResponseTypes.SUCCESS: 200,\n    ResponseTypes.RESOURCE_ERROR: 404,\n    ResponseTypes.PARAMETERS_ERROR: 400,\n    ResponseTypes.SYSTEM_ERROR: 500,\n}\n\nrooms = [\n    {\n        \"code\": \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n        \"size\": 215,\n        \"price\": 39,\n        \"longitude\": -0.09998975,\n        \"latitude\": 51.75436293,\n    },\n    {\n        \"code\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n        \"size\": 405,\n        \"price\": 66,\n        \"longitude\": 0.18228006,\n        \"latitude\": 51.74640997,\n    },\n    {\n        \"code\": \"913694c6-435a-4366-ba0d-da5334a611b2\",\n        \"size\": 56,\n        \"price\": 60,\n        \"longitude\": 0.27891577,\n        \"latitude\": 51.45994069,\n    },\n    {\n        \"code\": \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n        \"size\": 93,\n        \"price\": 48,\n        \"longitude\": 0.33894476,\n        \"latitude\": 51.39916678,\n    },\n]\n\n@blueprint.route(\"/rooms\", methods=[\"GET\"])\ndef room_list():\n    qrystr_params = {\n        \"filters\": {},\n    }\n\n    for arg, values in request.args.items():\n        if arg.startswith(\"filter_\"):\n            qrystr_params[\"filters\"][arg.replace(\"filter_\", \"\")] = values\n\n    request_object = build_room_list_request(\n        filters=qrystr_params[\"filters\"]\n    )\n\n    repo = MemRepo(rooms)\n    response = room_list_use_case(repo, request_object)\n\n    return Response(\n        json.dumps(response.value, cls=RoomJsonEncoder),\n        mimetype=\"application/json\",\n        status=STATUS_CODES[response.type],\n    )*** \n```", "```py\n***{\"type\": \"SystemError\", \"message\": \"TypeError: list() got an unexpected keyword argument 'filters'\"}*** \n```", "```py\n***import pytest\n\nfrom rentomatic.domain.room import Room\nfrom rentomatic.repository.memrepo import MemRepo\n\n@pytest.fixture\ndef room_dicts():\n    return [\n        {\n            \"code\": \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n            \"size\": 215,\n            \"price\": 39,\n            \"longitude\": -0.09998975,\n            \"latitude\": 51.75436293,\n        },\n        {\n            \"code\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n            \"size\": 405,\n            \"price\": 66,\n            \"longitude\": 0.18228006,\n            \"latitude\": 51.74640997,\n        },\n        {\n            \"code\": \"913694c6-435a-4366-ba0d-da5334a611b2\",\n            \"size\": 56,\n            \"price\": 60,\n            \"longitude\": 0.27891577,\n            \"latitude\": 51.45994069,\n        },\n        {\n            \"code\": \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n            \"size\": 93,\n            \"price\": 48,\n            \"longitude\": 0.33894476,\n            \"latitude\": 51.39916678,\n        },\n    ]\n\ndef test_repository_list_without_parameters(room_dicts):\n    repo = MemRepo(room_dicts)\n\n    rooms = [Room.from_dict(i) for i in room_dicts]\n\n    assert repo.list() == rooms\n\ndef test_repository_list_with_code_equal_filter(room_dicts):\n    repo = MemRepo(room_dicts)\n\n    rooms = repo.list(\n        filters={\"code__eq\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\"}\n    )\n\n    assert len(rooms) == 1\n    assert rooms[0].code == \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\"\n\n@pytest.mark.parametrize(\"price\", [60, \"60\"])\ndef test_repository_list_with_price_equal_filter(room_dicts, price):\n    repo = MemRepo(room_dicts)\n\n    rooms = repo.list(filters={\"price__eq\": price})\n\n    assert len(rooms) == 1\n    assert rooms[0].code == \"913694c6-435a-4366-ba0d-da5334a611b2\"\n\n@pytest.mark.parametrize(\"price\", [60, \"60\"])\ndef test_repository_list_with_price_less_than_filter(room_dicts, price):\n    repo = MemRepo(room_dicts)\n\n    rooms = repo.list(filters={\"price__lt\": price})\n\n    assert len(rooms) == 2\n    assert set([r.code for r in rooms]) == {\n        \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n        \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n    }\n\n@pytest.mark.parametrize(\"price\", [48, \"48\"])\ndef test_repository_list_with_price_greater_than_filter(room_dicts, price):\n    repo = MemRepo(room_dicts)\n\n    rooms = repo.list(filters={\"price__gt\": price})\n\n    assert len(rooms) == 2\n    assert set([r.code for r in rooms]) == {\n        \"913694c6-435a-4366-ba0d-da5334a611b2\",\n        \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n    }\n\ndef test_repository_list_with_price_between_filter(room_dicts):\n    repo = MemRepo(room_dicts)\n\n    rooms = repo.list(filters={\"price__lt\": 66, \"price__gt\": 48})\n\n    assert len(rooms) == 1\n    assert rooms[0].code == \"913694c6-435a-4366-ba0d-da5334a611b2\"*** \n```", "```py\n***from rentomatic.domain.room import Room\n\nclass MemRepo:\n    def __init__(self, data):\n        self.data = data\n\n    def list(self, filters=None):\n\n        result = [Room.from_dict(i) for i in self.data]\n\n        if filters is None:\n            return result\n\n        if \"code__eq\" in filters:\n            result = [r for r in result if r.code == filters[\"code__eq\"]]\n\n        if \"price__eq\" in filters:\n            result = [\n                r for r in result if r.price == int(filters[\"price__eq\"])\n            ]\n\n        if \"price__lt\" in filters:\n            result = [\n                r for r in result if r.price < int(filters[\"price__lt\"])\n            ]\n\n        if \"price__gt\" in filters:\n            result = [\n                r for r in result if r.price > int(filters[\"price__gt\"])\n            ]\n\n        return result*** \n```", "```py\n***#!/usr/bin/env python\n\nfrom rentomatic.repository.memrepo import MemRepo\nfrom rentomatic.use_cases.room_list import room_list_use_case\nfrom rentomatic.requests.room_list import build_room_list_request\n\nrooms = [\n    {\n        \"code\": \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n        \"size\": 215,\n        \"price\": 39,\n        \"longitude\": -0.09998975,\n        \"latitude\": 51.75436293,\n    },\n    {\n        \"code\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n        \"size\": 405,\n        \"price\": 66,\n        \"longitude\": 0.18228006,\n        \"latitude\": 51.74640997,\n    },\n    {\n        \"code\": \"913694c6-435a-4366-ba0d-da5334a611b2\",\n        \"size\": 56,\n        \"price\": 60,\n        \"longitude\": 0.27891577,\n        \"latitude\": 51.45994069,\n    },\n    {\n        \"code\": \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n        \"size\": 93,\n        \"price\": 48,\n        \"longitude\": 0.33894476,\n        \"latitude\": 51.39916678,\n    },\n]\n\nrequest = build_room_list_request()\nrepo = MemRepo(rooms)\nresponse = room_list_use_case(repo, request)\n\nprint([room.to_dict() for room in response.value])*** \n```"]
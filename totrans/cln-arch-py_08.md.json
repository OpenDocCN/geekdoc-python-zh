["```py\nfrom rentomatic.domain.room import Room\n\nclass MemRepo:\n    def __init__(self, data):\n        self.data = data\n\n    def list(self, filters=None):\n\n        result = [Room.from_dict(i) for i in self.data]\n\n        if filters is None:\n            return result\n\n        if \"code__eq\" in filters:\n            result = [r for r in result if r.code == filters[\"code__eq\"]]\n\n        if \"price__eq\" in filters:\n            result = [\n                r for r in result if r.price == int(filters[\"price__eq\"])\n            ]\n\n        if \"price__lt\" in filters:\n            result = [\n                r for r in result if r.price < int(filters[\"price__lt\"])\n            ]\n\n        if \"price__gt\" in filters:\n            result = [\n                r for r in result if r.price > int(filters[\"price__gt\"])\n            ]\n\n        return result \n```", "```py\nimport pytest\n\npytestmark = pytest.mark.integration\n\ndef test_dummy():\n    pass \n```", "```py\n[pytest]\nminversion = 2.0\nnorecursedirs = .git .tox requirements*\npython_files = test*.py\nmarkers =\n        integration: integration tests \n```", "```py\n$ pytest -svv -m integration\n========================= test session starts ===========================\nplatform linux -- Python XXXX, pytest-XXXX, py-XXXX, pluggy-XXXX --\ncabook/venv3/bin/python3\ncachedir: .cache\nrootdir: cabook/code/calc, inifile: pytest.ini\nplugins: cov-XXXX\ncollected 36 items / 35 deselected / 1 selected\n\ntests/repository/postgres/test_postgresrepo.py::test_dummy PASSED\n\n=================== 1 passed, 35 deselected in 0.20s ==================== \n```", "```py\ndef pytest_addoption(parser):\n    parser.addoption(\n        \"--integration\", action=\"store_true\", help=\"run integration tests\"\n    )\n\ndef pytest_runtest_setup(item):\n    if \"integration\" in item.keywords and not item.config.getvalue(\n        \"integration\"\n    ):\n        pytest.skip(\"need --integration option to run\") \n```", "```py\n$ pytest -svv --integration\n========================= test session starts ===========================\nplatform linux -- Python XXXX, pytest-XXXX, py-XXXX, pluggy-XXXX --\ncabook/venv3/bin/python3\ncachedir: .cache\nrootdir: cabook/code/calc, inifile: pytest.ini\nplugins: cov-XXXX\ncollected 36 items\n\n...\ntests/repository/postgres/test_postgresrepo.py::test_dummy PASSED\n...\n\n========================= 36 passed in 0.26s ============================ \n```", "```py\n$ pytest -svv \n========================= test session starts ===========================\nplatform linux -- Python XXXX, pytest-XXXX, py-XXXX, pluggy-XXXX --\ncabook/venv3/bin/python3\ncachedir: .cache\nrootdir: cabook/code/calc, inifile: pytest.ini\nplugins: cov-XXXX\ncollected 36 items\n\n...\ntests/repository/postgres/test_postgresrepo.py::test_dummy SKIPPED\n...\n\n=================== 35 passed, 1 skipped in 0.27s ======================= \n```", "```py\n*Flask\nSQLAlchemy\npsycopg2* \n```", "```py\n*$ pip install -r requirements/dev.txt* \n```", "```py\n*from sqlalchemy import Column, Integer, String, Float\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()\n\nclass Room(Base):\n    __tablename__ = 'room'\n\n    id = Column(Integer, primary_key=True)\n\n    code = Column(String(36), nullable=False)\n    size = Column(Integer)\n    price = Column(Integer)\n    longitude = Column(Float)\n    latitude = Column(Float)* \n```", "```py\n*from sqlalchemy import Column, Integer, String, Float\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()* \n```", "```py\n*class Room(Base):\n    __tablename__ = 'room'\n\n    id = Column(Integer, primary_key=True)\n\n    code = Column(String(36), nullable=False)\n    size = Column(Integer)\n    price = Column(Integer)\n    longitude = Column(Float)\n    latitude = Column(Float)* \n```", "```py\n**-r prod.txt\ntox\ncoverage\npytest\npytest-cov\npytest-flask\ndocker-compose** \n```", "```py\n**#! /usr/bin/env python\n\nimport os\nimport json\nimport subprocess\nimport time\n\nimport click\nimport psycopg2\nfrom psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT\n\n# Ensure an environment variable exists and has a value\ndef setenv(variable, default):\n    os.environ[variable] = os.getenv(variable, default)\n\nAPPLICATION_CONFIG_PATH = \"config\"\nDOCKER_PATH = \"docker\"\n\ndef app_config_file(config):\n    return os.path.join(APPLICATION_CONFIG_PATH, f\"{config}.json\")\n\ndef docker_compose_file(config):\n    return os.path.join(DOCKER_PATH, f\"{config}.yml\")\n\ndef read_json_configuration(config):\n    # Read configuration from the relative JSON file\n    with open(app_config_file(config)) as f:\n        config_data = json.load(f)\n\n    # Convert the config into a usable Python dictionary\n    config_data = dict((i[\"name\"], i[\"value\"]) for i in config_data)\n\n    return config_data\n\ndef configure_app(config):\n    configuration = read_json_configuration(config)\n\n    for key, value in configuration.items():\n        setenv(key, value)\n\n@click.group()\ndef cli():\n    pass\n\ndef docker_compose_cmdline(commands_string=None):\n    config = os.getenv(\"APPLICATION_CONFIG\")\n    configure_app(config)\n\n    compose_file = docker_compose_file(config)\n\n    if not os.path.isfile(compose_file):\n        raise ValueError(f\"The file {compose_file} does not exist\")\n\n    command_line = [\n        \"docker-compose\",\n        \"-p\",\n        config,\n        \"-f\",\n        compose_file,\n    ]\n\n    if commands_string:\n        command_line.extend(commands_string.split(\" \"))\n\n    return command_line\n\ndef run_sql(statements):\n    conn = psycopg2.connect(\n        dbname=os.getenv(\"POSTGRES_DB\"),\n        user=os.getenv(\"POSTGRES_USER\"),\n        password=os.getenv(\"POSTGRES_PASSWORD\"),\n        host=os.getenv(\"POSTGRES_HOSTNAME\"),\n        port=os.getenv(\"POSTGRES_PORT\"),\n    )\n\n    conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)\n    cursor = conn.cursor()\n    for statement in statements:\n        cursor.execute(statement)\n\n    cursor.close()\n    conn.close()\n\ndef wait_for_logs(cmdline, message):\n    logs = subprocess.check_output(cmdline)\n    while message not in logs.decode(\"utf-8\"):\n        time.sleep(1)\n        logs = subprocess.check_output(cmdline)\n\n@cli.command()\n@click.argument(\"args\", nargs=-1)\ndef test(args):\n    os.environ[\"APPLICATION_CONFIG\"] = \"testing\"\n    configure_app(os.getenv(\"APPLICATION_CONFIG\"))\n\n    cmdline = docker_compose_cmdline(\"up -d\")\n    subprocess.call(cmdline)\n\n    cmdline = docker_compose_cmdline(\"logs postgres\")\n    wait_for_logs(cmdline, \"ready to accept connections\")\n\n    run_sql([f\"CREATE DATABASE {os.getenv('APPLICATION_DB')}\"])\n\n    cmdline = [\n        \"pytest\",\n        \"-svv\",\n        \"--cov=application\",\n        \"--cov-report=term-missing\",\n    ]\n    cmdline.extend(args)\n    subprocess.call(cmdline)\n\n    cmdline = docker_compose_cmdline(\"down\")\n    subprocess.call(cmdline)\n\nif __name__ == \"__main__\":\n    cli()** \n```", "```py\n**#! /usr/bin/env python\n\nimport os\nimport json\nimport subprocess\nimport time\n\nimport click\nimport psycopg2\nfrom psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT\n\n# Ensure an environment variable exists and has a value\ndef setenv(variable, default):\n    os.environ[variable] = os.getenv(variable, default)\n\nAPPLICATION_CONFIG_PATH = \"config\"\nDOCKER_PATH = \"docker\"** \n```", "```py\n**def app_config_file(config):\n    return os.path.join(APPLICATION_CONFIG_PATH, f\"{config}.json\")\n\ndef docker_compose_file(config):\n    return os.path.join(DOCKER_PATH, f\"{config}.yml\")\n\ndef read_json_configuration(config):\n    # Read configuration from the relative JSON file\n    with open(app_config_file(config)) as f:\n        config_data = json.load(f)\n\n    # Convert the config into a usable Python dictionary\n    config_data = dict((i[\"name\"], i[\"value\"]) for i in config_data)\n\n    return config_data\n\ndef configure_app(config):\n    configuration = read_json_configuration(config)\n\n    for key, value in configuration.items():\n        setenv(key, value)** \n```", "```py\n**@click.group()\ndef cli():\n    pass\n\ndef docker_compose_cmdline(commands_string=None):\n    config = os.getenv(\"APPLICATION_CONFIG\")\n    configure_app(config)\n\n    compose_file = docker_compose_file(config)\n\n    if not os.path.isfile(compose_file):\n        raise ValueError(f\"The file {compose_file} does not exist\")\n\n    command_line = [\n        \"docker-compose\",\n        \"-p\",\n        config,\n        \"-f\",\n        compose_file,\n    ]\n\n    if commands_string:\n        command_line.extend(commands_string.split(\" \"))\n\n    return command_line** \n```", "```py\n**def run_sql(statements):\n    conn = psycopg2.connect(\n        dbname=os.getenv(\"POSTGRES_DB\"),\n        user=os.getenv(\"POSTGRES_USER\"),\n        password=os.getenv(\"POSTGRES_PASSWORD\"),\n        host=os.getenv(\"POSTGRES_HOSTNAME\"),\n        port=os.getenv(\"POSTGRES_PORT\"),\n    )\n\n    conn.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)\n    cursor = conn.cursor()\n    for statement in statements:\n        cursor.execute(statement)\n\n    cursor.close()\n    conn.close()\n\ndef wait_for_logs(cmdline, message):\n    logs = subprocess.check_output(cmdline)\n    while message not in logs.decode(\"utf-8\"):\n        time.sleep(1)\n        logs = subprocess.check_output(cmdline)** \n```", "```py\n**@cli.command()\n@click.argument(\"args\", nargs=-1)\ndef test(args):\n    os.environ[\"APPLICATION_CONFIG\"] = \"testing\"\n    configure_app(os.getenv(\"APPLICATION_CONFIG\"))\n\n    cmdline = docker_compose_cmdline(\"up -d\")\n    subprocess.call(cmdline)\n\n    cmdline = docker_compose_cmdline(\"logs postgres\")\n    wait_for_logs(cmdline, \"ready to accept connections\")\n\n    run_sql([f\"CREATE DATABASE {os.getenv('APPLICATION_DB')}\"])\n\n    cmdline = [\n        \"pytest\",\n        \"-svv\",\n        \"--cov=application\",\n        \"--cov-report=term-missing\",\n    ]\n    cmdline.extend(args)\n    subprocess.call(cmdline)\n\n    cmdline = docker_compose_cmdline(\"down\")\n    subprocess.call(cmdline)\n\nif __name__ == \"__main__\":\n    cli()** \n```", "```py\n**version: '3.8'\n\nservices:\n  postgres:\n    image: postgres\n    environment:\n      POSTGRES_DB: ${POSTGRES_DB}\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n    ports:\n      - \"${POSTGRES_PORT}:5432\"** \n```", "```py\n**[\n  {\n    \"name\": \"FLASK_ENV\",\n    \"value\": \"production\"\n  },\n  {\n    \"name\": \"FLASK_CONFIG\",\n    \"value\": \"testing\"\n  },\n  {\n    \"name\": \"POSTGRES_DB\",\n    \"value\": \"postgres\"\n  },\n  {\n    \"name\": \"POSTGRES_USER\",\n    \"value\": \"postgres\"\n  },\n  {\n    \"name\": \"POSTGRES_HOSTNAME\",\n    \"value\": \"localhost\"\n  },\n  {\n    \"name\": \"POSTGRES_PORT\",\n    \"value\": \"5433\"\n  },\n  {\n    \"name\": \"POSTGRES_PASSWORD\",\n    \"value\": \"postgres\"\n  },\n  {\n    \"name\": \"APPLICATION_DB\",\n    \"value\": \"test\"\n  }\n]** \n```", "```py\n***from manage import read_json_configuration\n\n...\n\n@pytest.fixture(scope=\"session\")\ndef app_configuration():\n    return read_json_configuration(\"testing\")*** \n```", "```py\n***import sqlalchemy\nimport pytest\n\nfrom rentomatic.repository.postgres_objects import Base, Room\n\n@pytest.fixture(scope=\"session\")\ndef pg_session_empty(app_configuration):\n    conn_str = \"postgresql+psycopg2://{}:{}@{}:{}/{}\".format(\n        app_configuration[\"POSTGRES_USER\"],\n        app_configuration[\"POSTGRES_PASSWORD\"],\n        app_configuration[\"POSTGRES_HOSTNAME\"],\n        app_configuration[\"POSTGRES_PORT\"],\n        app_configuration[\"APPLICATION_DB\"],\n    )\n    engine = sqlalchemy.create_engine(conn_str)\n    connection = engine.connect()\n\n    Base.metadata.create_all(engine)\n    Base.metadata.bind = engine\n\n    DBSession = sqlalchemy.orm.sessionmaker(bind=engine)\n    session = DBSession()\n\n    yield session\n\n    session.close()\n    connection.close\n\n@pytest.fixture(scope=\"session\")\ndef pg_test_data():\n    return [\n        {\n            \"code\": \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n            \"size\": 215,\n            \"price\": 39,\n            \"longitude\": -0.09998975,\n            \"latitude\": 51.75436293,\n        },\n        {\n            \"code\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n            \"size\": 405,\n            \"price\": 66,\n            \"longitude\": 0.18228006,\n            \"latitude\": 51.74640997,\n        },\n        {\n            \"code\": \"913694c6-435a-4366-ba0d-da5334a611b2\",\n            \"size\": 56,\n            \"price\": 60,\n            \"longitude\": 0.27891577,\n            \"latitude\": 51.45994069,\n        },\n        {\n            \"code\": \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n            \"size\": 93,\n            \"price\": 48,\n            \"longitude\": 0.33894476,\n            \"latitude\": 51.39916678,\n        },\n    ]\n\n@pytest.fixture(scope=\"function\")\ndef pg_session(pg_session_empty, pg_test_data):\n    for r in pg_test_data:\n        new_room = Room(\n            code=r[\"code\"],\n            size=r[\"size\"],\n            price=r[\"price\"],\n            longitude=r[\"longitude\"],\n            latitude=r[\"latitude\"],\n        )\n        pg_session_empty.add(new_room)\n        pg_session_empty.commit()\n\n    yield pg_session_empty\n\n    pg_session_empty.query(Room).delete()*** \n```", "```py\n***import pytest\nfrom rentomatic.repository.postgres_objects import Room\n\npytestmark = pytest.mark.integration\n\ndef test_dummy(pg_session):\n    assert len(pg_session.query(Room).all()) == 4*** \n```", "```py\n***$ ./manage.py test -- --integration\n========================= test session starts ===========================\nplatform linux -- Python XXXX, pytest-XXXX, py-XXXX, pluggy-XXXX --\ncabook/venv3/bin/python3\ncachedir: .cache\nrootdir: cabook/code/calc, inifile: pytest.ini\nplugins: cov-XXXX\ncollected 36 items\n\n...\ntests/repository/postgres/test_postgresrepo.py::test_dummy PASSED\n...\n\n========================= 36 passed in 0.26s ============================*** \n```", "```py\n***import pytest\nfrom rentomatic.repository import postgresrepo\n\npytestmark = pytest.mark.integration\n\ndef test_repository_list_without_parameters(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list()\n\n    assert set([r.code for r in repo_rooms]) == set(\n        [r[\"code\"] for r in pg_test_data]\n    )\n\ndef test_repository_list_with_code_equal_filter(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list(\n        filters={\"code__eq\": \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\"}\n    )\n\n    assert len(repo_rooms) == 1\n    assert repo_rooms[0].code == \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\"\n\ndef test_repository_list_with_price_equal_filter(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list(filters={\"price__eq\": 60})\n\n    assert len(repo_rooms) == 1\n    assert repo_rooms[0].code == \"913694c6-435a-4366-ba0d-da5334a611b2\"\n\ndef test_repository_list_with_price_less_than_filter(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list(filters={\"price__lt\": 60})\n\n    assert len(repo_rooms) == 2\n    assert set([r.code for r in repo_rooms]) == {\n        \"f853578c-fc0f-4e65-81b8-566c5dffa35a\",\n        \"eed76e77-55c1-41ce-985d-ca49bf6c0585\",\n    }\n\ndef test_repository_list_with_price_greater_than_filter(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list(filters={\"price__gt\": 48})\n\n    assert len(repo_rooms) == 2\n    assert set([r.code for r in repo_rooms]) == {\n        \"913694c6-435a-4366-ba0d-da5334a611b2\",\n        \"fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a\",\n    }\n\ndef test_repository_list_with_price_between_filter(\n    app_configuration, pg_session, pg_test_data\n):\n    repo = postgresrepo.PostgresRepo(app_configuration)\n\n    repo_rooms = repo.list(filters={\"price__lt\": 66, \"price__gt\": 48})\n\n    assert len(repo_rooms) == 1\n    assert repo_rooms[0].code == \"913694c6-435a-4366-ba0d-da5334a611b2\"*** \n```", "```py\n***from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\n\nfrom rentomatic.domain import room\nfrom rentomatic.repository.postgres_objects import Base, Room\n\nclass PostgresRepo:\n    def __init__(self, configuration):\n        connection_string = \"postgresql+psycopg2://{}:{}@{}:{}/{}\".format(\n            configuration[\"POSTGRES_USER\"],\n            configuration[\"POSTGRES_PASSWORD\"],\n            configuration[\"POSTGRES_HOSTNAME\"],\n            configuration[\"POSTGRES_PORT\"],\n            configuration[\"APPLICATION_DB\"],\n        )\n\n        self.engine = create_engine(connection_string)\n        Base.metadata.create_all(self.engine)\n        Base.metadata.bind = self.engine\n\n    def _create_room_objects(self, results):\n        return [\n            room.Room(\n                code=q.code,\n                size=q.size,\n                price=q.price,\n                latitude=q.latitude,\n                longitude=q.longitude,\n            )\n            for q in results\n        ]\n\n    def list(self, filters=None):\n        DBSession = sessionmaker(bind=self.engine)\n        session = DBSession()\n\n        query = session.query(Room)\n\n        if filters is None:\n            return self._create_room_objects(query.all())\n\n        if \"code__eq\" in filters:\n            query = query.filter(Room.code == filters[\"code__eq\"])\n\n        if \"price__eq\" in filters:\n            query = query.filter(Room.price == filters[\"price__eq\"])\n\n        if \"price__lt\" in filters:\n            query = query.filter(Room.price < filters[\"price__lt\"])\n\n        if \"price__gt\" in filters:\n            query = query.filter(Room.price > filters[\"price__gt\"])\n\n        return self._create_room_objects(query.all())*** \n```"]